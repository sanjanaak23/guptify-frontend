<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Verification Issues - Troubleshooting</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-12 max-w-4xl">
        <div class="bg-white rounded-lg shadow-md p-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Email Verification Issues</h1>
            <p class="text-gray-600 mb-8">If you're not receiving verification emails, follow this troubleshooting guide.</p>
            
            <div class="space-y-6">
                <!-- Step 1 -->
                <div class="border-l-4 border-blue-500 pl-4 py-2">
                    <h2 class="text-xl font-semibold text-gray-800">1. Check Spam/Junk Folder</h2>
                    <p class="text-gray-600 mt-2">Verification emails often get filtered as spam. Check your spam, junk, promotions, and other folders.</p>
                </div>
                
                <!-- Step 2 -->
                <div class="border-l-4 border-blue-500 pl-4 py-2">
                    <h2 class="text-xl font-semibold text-gray-800">2. Wait a Few Minutes</h2>
                    <p class="text-gray-600 mt-2">Email delivery can sometimes take 2-5 minutes. Wait a bit and check again.</p>
                </div>
                
                <!-- Step 3 -->
                <div class="border-l-4 border-blue-500 pl-4 py-2">
                    <h2 class="text-xl font-semibold text-gray-800">3. Resend Verification Email</h2>
                    <p class="text-gray-600 mt-2">Click the button below to resend the verification email.</p>
                    <button id="resendBtn" class="mt-3 bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-md transition duration-200">
                        Resend Verification Email
                    </button>
                    <div id="resendStatus" class="mt-2 text-sm hidden"></div>
                </div>
                
                <!-- Step 4 -->
                <div class="border-l-4 border-blue-500 pl-4 py-2">
                    <h2 class="text-xl font-semibold text-gray-800">4. Check Email Address</h2>
                    <p class="text-gray-600 mt-2">Make sure you entered your email address correctly.</p>
                    <div class="mt-3">
                        <label class="block text-sm font-medium text-gray-700">Your Email Address</label>
                        <input type="email" id="emailInput" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
                
                <!-- Step 5 -->
                <div class="border-l-4 border-blue-500 pl-4 py-2">
                    <h2 class="text-xl font-semibold text-gray-800">5. Domain Blocking Issues</h2>
                    <p class="text-gray-600 mt-2">Some email providers block emails from Supabase's domain. Try using a different email provider (Gmail, Outlook, etc.).</p>
                </div>
                
                <!-- Step 6 -->
                <div class="border-l-4 border-blue-500 pl-4 py-2">
                    <h2 class="text-xl font-semibold text-gray-800">6. Check Supabase Configuration</h2>
                    <p class="text-gray-600 mt-2">If you're the application administrator, check these common configuration issues:</p>
                    <ul class="list-disc pl-5 mt-2 text-gray-600 space-y-1">
                        <li>SMTP settings are not configured in Supabase</li>
                        <li>Email rate limits exceeded</li>
                        <li>Custom domain not properly configured</li>
                    </ul>
                </div>
                
                <!-- Step 7 -->
                <div class="border-l-4 border-blue-500 pl-4 py-2">
                    <h2 class="text-xl font-semibold text-gray-800">7. Still Not Working?</h2>
                    <p class="text-gray-600 mt-2">If you've tried all steps and still can't receive the email, contact support with the following information:</p>
                    <div class="mt-3 bg-gray-100 p-4 rounded-md">
                        <p class="text-sm text-gray-700">Email address: <span id="userEmail">user@example.com</span></p>
                        <p class="text-sm text-gray-700">Time of request: <span id="requestTime">-</span></p>
                        <p class="text-sm text-gray-700">Last error: <span id="lastError">None</span></p>
                    </div>
                    <button class="mt-3 bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-md transition duration-200">
                        Contact Support
                    </button>
                </div>
            </div>
            
            <div class="mt-10 pt-6 border-t border-gray-200">
                <h3 class="text-lg font-medium text-gray-800">Developer Notes</h3>
                <p class="text-gray-600 mt-2">If you're developing this application, make sure to:</p>
                <ol class="list-decimal pl-5 mt-2 text-gray-600 space-y-1">
                    <li>Configure SMTP settings in your Supabase project</li>
                    <li>Set up proper redirect URLs in Authentication settings</li>
                    <li>Check that your email template includes {{ .ConfirmationURL }}</li>
                    <li>Verify your domain if using a custom email domain</li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const emailInput = document.getElementById('emailInput');
            const resendBtn = document.getElementById('resendBtn');
            const resendStatus = document.getElementById('resendStatus');
            const userEmail = document.getElementById('userEmail');
            const requestTime = document.getElementById('requestTime');
            const lastError = document.getElementById('lastError');
            
            // Try to get the email from URL parameters or localStorage
            const urlParams = new URLSearchParams(window.location.search);
            const email = urlParams.get('email') || localStorage.getItem('signup_email') || '';
            
            if (email) {
                emailInput.value = email;
                userEmail.textContent = email;
            }
            
            // Update request time
            requestTime.textContent = new Date().toLocaleString();
            
            // Resend button handler
            resendBtn.addEventListener('click', function() {
                const email = emailInput.value;
                if (!email) {
                    showStatus('Please enter your email address', 'error');
                    return;
                }
                
                showStatus('Sending verification email...', 'info');
                
                // In a real application, you would call your backend API here
                simulateResendEmail(email);
            });
            
            function simulateResendEmail(email) {
                // Simulate API call delay
                setTimeout(() => {
                    // This is a simulation - in a real app, you would use your API
                    const success = Math.random() > 0.3; // 70% success rate for demo
                    
                    if (success) {
                        showStatus('Verification email sent! Check your inbox.', 'success');
                        lastError.textContent = 'None';
                    } else {
                        showStatus('Failed to send email. Please try again later.', 'error');
                        lastError.textContent = 'SMTP server not configured';
                    }
                }, 1500);
            }
            
            function showStatus(message, type) {
                resendStatus.textContent = message;
                resendStatus.className = 'mt-2 text-sm';
                
                if (type === 'error') {
                    resendStatus.classList.add('text-red-600');
                } else if (type === 'success') {
                    resendStatus.classList.add('text-green-600');
                } else {
                    resendStatus.classList.add('text-blue-600');
                }
                
                resendStatus.classList.remove('hidden');
            }
        });
    </script>
</body>
</html>